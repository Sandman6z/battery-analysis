#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Comprehensive internationalization script for main_window.py
"""

import re
import os

def internationalize_main_window():
    """Internationalize all Chinese text in main_window.py"""
    
    python_file = "src/battery_analysis/main/main_window.py"
    
    # Read the file
    with open(python_file, 'r', encoding='utf-8') as f:
        content = f.read()
    
    original_content = content
    
    # Define comprehensive replacement rules for main_window.py
    replacements = {
        # Module docstring
        'ç”µæ± åˆ†æä¸»çª—å£æ¨¡å—': 'Battery Analysis Main Window Module',
        'è¿™ä¸ªæ¨¡å—å®ç°äº†ç”µæ± åˆ†æåº”ç”¨çš„ä¸»çª—å£ç•Œé¢å’Œæ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š': 'This module implements the main window interface and core functionality of the battery analysis application, including:',
        '- çª—å£åˆå§‹åŒ–å’Œå¸ƒå±€è®¾ç½®': '- Window initialization and layout settings',
        '- é…ç½®æ–‡ä»¶ç®¡ç†': '- Configuration file management',
        '- æ§åˆ¶å™¨è¿æ¥å’Œä¿¡å·å¤„ç†': '- Controller connection and signal processing',
        '- ç”¨æˆ·äº¤äº’ç•Œé¢': '- User interaction interface',
        
        # Comment sections
        '# æ ‡å‡†åº“å¯¼å…¥': '# Standard library imports',
        '# ç¬¬ä¸‰æ–¹åº“å¯¼å…¥': '# Third-party library imports', 
        '# æœ¬åœ°åº”ç”¨/åº“å¯¼å…¥': '# Local application/library imports',
        '# é…ç½®æ—¥å¿—': '# Configure logging',
        
        # Function docstrings and comments
        'åœ¨æ¨¡å—çº§åˆ«å®šä¹‰çš„å¯è§†åŒ–å·¥å…·è¿è¡Œå‡½æ•°': 'Visualizer tool run function defined at module level',
        'åˆ›å»ºå¯è§†åŒ–å™¨æ§åˆ¶å™¨å®ä¾‹': 'Create visualizer controller instance',
        'åˆ›å»ºå¹¶æ˜¾ç¤ºå¯è§†åŒ–å™¨': 'Create and display visualizer',
        'å¯åŠ¨å¯è§†åŒ–å·¥å…·whenerror occurred': 'Start visualizer tool when error occurred',
        'å¼¹å‡ºå¼è¿›åº¦æ¡å¯¹è¯æ¡†ç±»': 'Pop-up progress bar dialog class',
        'ç”¨äºæ˜¾ç¤ºè¯¦ç»†çš„è¿›åº¦ä¿¡æ¯ï¼Œé€‚åˆé•¿whené—´è¿è¡Œçš„ä»»åŠ¡': 'Used to display detailed progress information, suitable for long-running tasks',
        'åˆå§‹åŒ–å¼¹å‡ºå¼è¿›åº¦æ¡': 'Initialize pop-up progress bar',
        'parent: çˆ¶çª—å£': 'parent: parent window',
        
        # Window titles and UI text
        'ç”µæ± åˆ†æè¿›åº¦': 'Battery Analysis Progress',
        'éæ¨¡æ€çª—å£ï¼Œå…è®¸ç”¨æˆ·åŒwhenæ“ä½œä¸»ç•Œé¢': 'Non-modal window, allowing users to operate main interface simultaneously',
        
        # Common technical terms
        'é”™è¯¯': 'Error',
        'æˆåŠŸ': 'Success', 
        'å¤±è´¥': 'Failed',
        'è­¦å‘Š': 'Warning',
        'ä¿¡æ¯': 'Info',
        'ç¡®è®¤': 'Confirm',
        'å–æ¶ˆ': 'Cancel',
        'ä¿å­˜': 'Save',
        'åŠ è½½': 'Load',
        'æ–‡ä»¶': 'File',
        'ç›®å½•': 'Directory',
        'é€‰æ‹©': 'Select',
        'æ‰“å¼€': 'Open',
        'å…³é—­': 'Close',
        'é€€å‡º': 'Exit',
        'è®¾ç½®': 'Settings',
        'é…ç½®': 'Configuration',
        'å¸®åŠ©': 'Help',
        'å…³äº': 'About',
        'çŠ¶æ€': 'Status',
        'è¿›åº¦': 'Progress',
        'å®Œæˆ': 'Complete',
        'å¤„ç†': 'Process',
        'åˆ†æ': 'Analysis',
        'æ•°æ®': 'Data',
        'å›¾è¡¨': 'Chart',
        'æ˜¾ç¤º': 'Display',
        'éšè—': 'Hide',
        'åˆ·æ–°': 'Refresh',
        'æ›´æ–°': 'Update',
        'æ–°å»º': 'New',
        'ç¼–è¾‘': 'Edit',
        'åˆ é™¤': 'Delete',
        'å¤åˆ¶': 'Copy',
        'ç²˜è´´': 'Paste',
        'æŸ¥æ‰¾': 'Find',
        'æœç´¢': 'Search',
        'æ›¿æ¢': 'Replace',
        'æ’¤é”€': 'Undo',
        'é‡åš': 'Redo',
        'æ‰“å°': 'Print',
        'é¢„è§ˆ': 'Preview',
        'å¯¼å‡º': 'Export',
        'å¯¼å…¥': 'Import',
        'åŒæ­¥': 'Sync',
        'è¿æ¥': 'Connect',
        'æ–­å¼€': 'Disconnect',
        'å‘é€': 'Send',
        'æ¥æ”¶': 'Receive',
        'ä¸Šä¼ ': 'Upload',
        'ä¸‹è½½': 'Download',
        'éªŒè¯': 'Validate',
        'æ£€æŸ¥': 'Check',
        'æµ‹è¯•': 'Test',
        'è°ƒè¯•': 'Debug',
        'æ—¥å¿—': 'Log',
        'è®°å½•': 'Record',
        'ç›‘æ§': 'Monitor',
        'è·Ÿè¸ª': 'Track',
        'ç»Ÿè®¡': 'Statistics',
        'æŠ¥å‘Š': 'Report',
        'ç”Ÿæˆ': 'Generate',
        'åˆ›å»º': 'Create',
        'åˆå§‹åŒ–': 'Initialize',
        'å®‰è£…': 'Install',
        'å¸è½½': 'Uninstall',
        'å‡çº§': 'Upgrade',
        'ä¿®å¤': 'Fix',
        'ä¼˜åŒ–': 'Optimize',
        'æ€§èƒ½': 'Performance',
        'é€Ÿåº¦': 'Speed',
        'å†…å­˜': 'Memory',
        'ç½‘ç»œ': 'Network',
        'è¿æ¥': 'Connection',
        'ç«¯å£': 'Port',
        'æœåŠ¡å™¨': 'Server',
        'å®¢æˆ·ç«¯': 'Client',
        'åè®®': 'Protocol',
        'è¯·æ±‚': 'Request',
        'å“åº”': 'Response',
        'æœåŠ¡': 'Service',
        'è¿›ç¨‹': 'Process',
        'çº¿ç¨‹': 'Thread',
        'ä»»åŠ¡': 'Task',
        'ä½œä¸š': 'Job',
        'é˜Ÿåˆ—': 'Queue',
        'å †æ ˆ': 'Stack',
        'ç¼“å­˜': 'Cache',
        'ç¼“å†²': 'Buffer',
        'æµ': 'Stream',
        'é€šé“': 'Channel',
        'ç®¡é“': 'Pipe',
        'ä¿¡å·': 'Signal',
        'äº‹ä»¶': 'Event',
        'å¼‚å¸¸': 'Exception',
        'é€šçŸ¥': 'Notification',
        'æ¶ˆæ¯': 'Message',
        'æç¤º': 'Hint',
        'è¯´æ˜': 'Description',
        'æ–‡æ¡£': 'Documentation',
        'æ‰‹å†Œ': 'Manual',
        'æŒ‡å—': 'Guide',
        'æ•™ç¨‹': 'Tutorial',
        'ç¤ºä¾‹': 'Example',
        'æ ·ä¾‹': 'Sample',
        'æ¨¡æ¿': 'Template',
        'æ ·å¼': 'Style',
        'ä¸»é¢˜': 'Theme',
        'çš®è‚¤': 'Skin',
        'å¸ƒå±€': 'Layout',
        'ä½ç½®': 'Position',
        'åæ ‡': 'Coordinate',
        'å¤§å°': 'Size',
        'å®½åº¦': 'Width',
        'é«˜åº¦': 'Height',
        'é•¿åº¦': 'Length',
        'è·ç¦»': 'Distance',
        'è§’åº¦': 'Angle',
        'æ–¹å‘': 'Direction',
        'æ¨¡å¼': 'Mode',
        'ç±»å‹': 'Type',
        'ç±»åˆ«': 'Category',
        'åˆ†ç±»': 'Classification',
        'åˆ†ç»„': 'Group',
        'é›†åˆ': 'Collection',
        'åˆ—è¡¨': 'List',
        'æ•°ç»„': 'Array',
        'çŸ©é˜µ': 'Matrix',
        'å‘é‡': 'Vector',
        'ç‚¹': 'Point',
        'çº¿': 'Line',
        'é¢': 'Surface',
        'ä½“': 'Volume',
        'åŒºåŸŸ': 'Region',
        'èŒƒå›´': 'Range',
        'åŒºé—´': 'Interval',
        'æ®µ': 'Segment',
        'éƒ¨åˆ†': 'Part',
        'æ•´ä½“': 'Whole',
        'æ‰€æœ‰': 'All',
        'æ¯ä¸ª': 'Each',
        'ä»»æ„': 'Any',
        'ç‰¹å®š': 'Specific',
        'é»˜è®¤': 'Default',
        'å½“å‰': 'Current',
        'æœ€æ–°': 'Latest',
        'æ—§': 'Old',
        'æ–°': 'New',
        'ç¬¬ä¸€ä¸ª': 'First',
        'æœ€åä¸€ä¸ª': 'Last',
        'ä¸‹ä¸€ä¸ª': 'Next',
        'ä¸Šä¸€ä¸ª': 'Previous',
        'å‰ä¸€ä¸ª': 'Previous',
        'åä¸€ä¸ª': 'Next',
        'å¼€å§‹': 'Start',
        'ç»“æŸ': 'End',
        'ç»ˆæ­¢': 'Terminate',
        'æš‚åœ': 'Pause',
        'ç»§ç»­': 'Continue',
        'æ¢å¤': 'Resume',
        'ä¸­æ–­': 'Interrupt',
        'è·³è¿‡': 'Skip',
        'é‡è¯•': 'Retry',
        'é‡æ–°': 'Re',
        'å†æ¬¡': 'Again',
        'é‡å¤': 'Repeat',
        'å¾ªç¯': 'Loop',
        'è¿­ä»£': 'Iterate',
        'éå†': 'Traverse',
        'åŒ¹é…': 'Match',
        'æ¯”è¾ƒ': 'Compare',
        'å¯¹æ¯”': 'Compare',
        'åŒºåˆ†': 'Distinguish',
        'è¯†åˆ«': 'Identify',
        'æ£€æµ‹': 'Detect',
        'å‘ç°': 'Discover',
        'æ‰¾åˆ°': 'Found',
        'è·å–': 'Get',
        'è·å¾—': 'Obtain',
        'è¯»å–': 'Read',
        'å†™å…¥': 'Write',
        'å­˜å‚¨': 'Store',
        'ä¸´æ—¶': 'Temporary',
        'æ°¸ä¹…': 'Permanent',
        'æŒä¹…': 'Persistent',
        'ä¸´æ—¶æ–‡ä»¶': 'Temporary File',
        'æ—¥å¿—æ–‡ä»¶': 'Log File',
        'é…ç½®æ–‡ä»¶': 'Configuration File',
        'æ•°æ®æ–‡ä»¶': 'Data File',
        'ç»“æœæ–‡ä»¶': 'Result File',
        'è¾“å‡ºæ–‡ä»¶': 'Output File',
        'è¾“å…¥æ–‡ä»¶': 'Input File',
        'æºæ–‡ä»¶': 'Source File',
        'ç›®æ ‡æ–‡ä»¶': 'Target File',
        'å¤‡ä»½æ–‡ä»¶': 'Backup File',
        'åŸå§‹æ•°æ®': 'Original Data',
        'å¤„ç†æ•°æ®': 'Processed Data',
        'åˆ†æç»“æœ': 'Analysis Result',
        'è®¡ç®—ç»“æœ': 'Calculation Result',
        'æµ‹è¯•ç»“æœ': 'Test Result',
        'æ‰§è¡Œç»“æœ': 'Execution Result',
        'è¿è¡Œç»“æœ': 'Run Result',
        'æ“ä½œç»“æœ': 'Operation Result',
        'åŠŸèƒ½ç»“æœ': 'Function Result',
        'æ–¹æ³•ç»“æœ': 'Method Result',
        'è¿‡ç¨‹ç»“æœ': 'Process Result',
        'æ­¥éª¤ç»“æœ': 'Step Result',
        'é˜¶æ®µç»“æœ': 'Phase Result',
        'çŠ¶æ€ç»“æœ': 'Status Result',
        'æ¡ä»¶ç»“æœ': 'Condition Result',
        'é€»è¾‘ç»“æœ': 'Logic Result',
        'å¸ƒå°”ç»“æœ': 'Boolean Result',
        'æ•°å€¼ç»“æœ': 'Numeric Result',
        'æ–‡æœ¬ç»“æœ': 'Text Result',
        'å­—ç¬¦ä¸²ç»“æœ': 'String Result',
        'å­—ç¬¦ç»“æœ': 'Character Result',
        'ç¬¦å·ç»“æœ': 'Symbol Result',
        'æ ‡è®°ç»“æœ': 'Token Result',
        'å…³é”®å­—ç»“æœ': 'Keyword Result',
        'æ ‡è¯†ç¬¦ç»“æœ': 'Identifier Result',
        'åç§°ç»“æœ': 'Name Result',
        'æ ‡é¢˜ç»“æœ': 'Title Result',
        'æ ‡ç­¾ç»“æœ': 'Label Result',
        'æ³¨é‡Šç»“æœ': 'Comment Result',
        'è¯´æ˜ç»“æœ': 'Description Result',
        'æè¿°ç»“æœ': 'Description Result',
        'è§£é‡Šç»“æœ': 'Explanation Result',
        'æ€»ç»“ç»“æœ': 'Summary Result',
        'æ‘˜è¦ç»“æœ': 'Abstract Result',
        'æ¦‚è¿°ç»“æœ': 'Overview Result',
        'æ¦‚è§ˆç»“æœ': 'Overview Result',
        'æµè§ˆç»“æœ': 'Browse Result',
        'æŸ¥çœ‹ç»“æœ': 'View Result',
        'å±•ç¤ºç»“æœ': 'Show Result',
        'å‘ˆç°ç»“æœ': 'Present Result',
        'è¡¨ç°ç»“æœ': 'Performance Result',
        'æ¼”ç¤ºç»“æœ': 'Demo Result',
        
        # Remove common Chinese characters that appear in mixed text
        'å½“': 'when',
        'å’Œ': 'and',
        'çš„': '',
        'ä¸': 'and',
        'ä¸º': 'is',
        'åœ¨': 'in',
        'å¯¹': 'for',
        'ä»': 'from',
        'åˆ°': 'to',
        'ç”±': 'by',
        'å‘': 'to',
        'å¾€': 'to',
        'æœ': 'towards',
        'ç”¨': 'use',
        'ä½¿': 'make',
        'æŠŠ': 'put',
        'å°†': 'will',
        'éœ€è¦': 'need',
        'åº”è¯¥': 'should',
        'å¿…é¡»': 'must',
        'å¯ä»¥': 'can',
        'èƒ½å¤Ÿ': 'can',
        'å¯èƒ½': 'may',
        'ä¹Ÿè®¸': 'maybe',
        'æˆ–è®¸': 'perhaps',
        'å¤§æ¦‚': 'probably',
        'ç¡®å®': 'indeed',
        'çœŸçš„': 'really',
        'çœŸçš„': 'truly',
        'ç¡®å®': 'certainly',
        'ç»å¯¹': 'absolutely',
        'å®Œå…¨': 'completely',
        'å®Œå…¨': 'totally',
        'ååˆ†': 'very',
        'éå¸¸': 'very',
        'ç‰¹åˆ«': 'especially',
        'å°¤å…¶': 'particularly',
        'ç‰¹åˆ«': 'particularly',
        'ä¸»è¦': 'mainly',
        'é‡è¦': 'important',
        'å…³é”®': 'key',
        'æ ¸å¿ƒ': 'core',
        'åŸºæœ¬': 'basic',
        'åŸºç¡€': 'foundation',
        'æ ¹æœ¬': 'fundamental',
        'æœ¬è´¨': 'essence',
        'å®è´¨': 'substance',
        'çœŸå®': 'real',
        'å®é™…': 'actual',
        'ç¡®å®': 'actual',
        'çœŸæ­£': 'truly',
        'ç¡®å®': 'definitely',
        'ä¸€å®š': 'certain',
        'ç¡®å®š': 'certain',
        'æ˜ç¡®': 'clear',
        'æ¸…æ¥š': 'clear',
        'æ˜ç™½': 'understand',
        'äº†è§£': 'understand',
        'çŸ¥é“': 'know',
        'è®¤è¯†': 'know',
        'ç†è§£': 'understand',
        'æ‡‚å¾—': 'understand',
        'æŒæ¡': 'master',
        'æ§åˆ¶': 'control',
        'ç®¡ç†': 'manage',
        'å¤„ç†': 'handle',
        'æ“ä½œ': 'operate',
        'æ‰§è¡Œ': 'execute',
        'å®æ–½': 'implement',
        'è½å®': 'implement',
        'å®è¡Œ': 'implement',
        'åº”ç”¨': 'apply',
        'ä½¿ç”¨': 'use',
        'è¿ç”¨': 'use',
        'åˆ©ç”¨': 'utilize',
        'é‡‡ç”¨': 'adopt',
        'é€‰æ‹©': 'choose',
        'æŒ‘é€‰': 'select',
        'é€‰å–': 'select',
        'æå–': 'extract',
        'æ”¶é›†': 'collect',
        'æ•´ç†': 'organize',
        'ç»„ç»‡': 'organize',
        'å®‰æ’': 'arrange',
        'è®¡åˆ’': 'plan',
        'è§„åˆ’': 'plan',
        'è®¾è®¡': 'design',
        'å»ºé€ ': 'build',
        'å»ºè®¾': 'build',
        'æ„å»º': 'build',
        'æ„é€ ': 'construct',
        'åˆ¶ä½œ': 'make',
        'ç”Ÿäº§': 'produce',
        'åˆ›é€ ': 'create',
        'åˆ›æ–°': 'innovate',
        'å‘æ˜': 'invent',
        'å‘ç°': 'discover',
        'ç ”å‘': 'research',
        'å¼€å‘': 'develop',
        'å‘å±•': 'develop',
        'è¿›åŒ–': 'evolve',
        'æ¼”å˜': 'evolve',
        'å˜åŒ–': 'change',
        'è½¬å˜': 'transform',
        'è½¬æ¢': 'convert',
        'è½¬åŒ–': 'transform',
        'ä¿®æ”¹': 'modify',
        'å˜æ›´': 'change',
        'å˜åŠ¨': 'change',
        'è°ƒæ•´': 'adjust',
        'è°ƒèŠ‚': 'adjust',
        'é€‚åº”': 'adapt',
        'é€‚åˆ': 'suitable',
        'åˆé€‚': 'appropriate',
        'æ°å½“': 'proper',
        'é€‚å½“': 'proper',
        'é€‚åº¦': 'moderate',
        'é€‚é‡': 'appropriate amount',
        'è¶³å¤Ÿ': 'enough',
        'å……åˆ†': 'sufficient',
        'å……è¶³': 'adequate',
        'æ»¡è¶³': 'satisfy',
        'æ»¡æ„': 'satisfied',
        'é«˜å…´': 'happy',
        'å¿«ä¹': 'happy',
        'æ„‰å¿«': 'happy',
        'å¼€å¿ƒ': 'happy',
        'å…´å¥‹': 'excited',
        'æ¿€åŠ¨': 'excited',
        'çƒ­æƒ…': 'enthusiastic',
        'ç§¯æ': 'positive',
        'ä¸»åŠ¨': 'active',
        'è‡ªå‘': 'spontaneous',
        'è‡ªç„¶': 'natural',
        'è‡ªåŠ¨': 'automatic',
        'æœ¬èƒ½': 'instinctive',
        'å¤©ç„¶': 'natural',
        'é‡ç”Ÿ': 'wild',
        'äººå·¥': 'artificial',
        'äººé€ ': 'artificial',
        'åˆæˆ': 'synthetic',
        'å¤åˆ': 'composite',
        'æ··åˆ': 'mixed',
        'ç»„åˆ': 'combined',
        'é…åˆ': 'coordinate',
        'åè°ƒ': 'coordinate',
        'åˆä½œ': 'cooperation',
        'åä½œ': 'cooperation',
        'å¸®åŠ©': 'help',
        'ååŠ©': 'assist',
        'æ”¯æ´': 'support',
        'æ”¯æŒ': 'support',
        'æ”¯æ’‘': 'support',
        'ç»´æŒ': 'maintain',
        'ä¿æŒ': 'keep',
        'åšæŒ': 'persist',
        'æŒç»­': 'continue',
        'è¿ç»­': 'continuous',
        'å»¶ä¼¸': 'extend',
        'å»¶é•¿': 'extend',
        'æ‰©å±•': 'expand',
        'æ‰©å¤§': 'expand',
        'æ”¾å¤§': 'enlarge',
        'ç¼©å°': 'reduce',
        'å‡å°': 'decrease',
        'å‡å°‘': 'decrease',
        'é™ä½': 'decrease',
        'ä¸‹é™': 'decrease',
        'ä¸‹è·Œ': 'decrease',
        'æ‰è½': 'fall',
        'è·Œè½': 'fall',
        'è½ä¸‹': 'fall',
        'ä¸‹æ²‰': 'sink',
        'ä¸‹è¡Œ': 'downward',
        'ä¸Šå‡': 'upward',
        'ä¸Š': 'up',
        'ä¸‹': 'down',
        'é«˜': 'high',
        'ä½': 'low',
        'é•¿': 'long',
        'çŸ­': 'short',
        'å¤§': 'big',
        'å°': 'small',
        'å¤š': 'many',
        'å°‘': 'few',
        'ä¸Š': 'above',
        'ä¸‹': 'below',
        'å†…': 'inside',
        'å¤–': 'outside',
        'ä¸­': 'middle',
        'é—´': 'between',
        'å‰': 'before',
        'å': 'after',
        'å·¦': 'left',
        'å³': 'right',
        'ä¸œ': 'east',
        'è¥¿': 'west',
        'å—': 'south',
        'åŒ—': 'north',
        'é‡Œ': 'inside',
        'å¤–': 'outside',
        'æ—': 'beside',
        'è¾¹': 'side',
        'æ²¿': 'along',
        'é ': 'near',
        'é‚»': 'near',
        'è¿‘': 'near',
        'è¿œ': 'far',
        'æ—è¾¹': 'beside',
        'é™„è¿‘': 'nearby',
        'é‚»è¿‘': 'adjacent',
        'å‘¨å›´': 'around',
        'å‘¨å›´': 'surrounding',
        'é™„è¿‘': 'near',
        'å‘¨å›´': 'around',
        'å‘¨å›´': 'surrounding'
    }
    
    # Apply replacements
    changes_made = 0
    for chinese, english in replacements.items():
        if chinese in content:
            content = content.replace(chinese, english)
            changes_made += 1
    
    # Handle remaining mixed patterns with regex
    # Pattern: Chinese word + English word + Chinese word
    mixed_pattern1 = r'([ä¸€-é¾¯]+)([A-Z][a-zA-Z]*)([ä¸€-é¾¯]+)'
    content = re.sub(mixed_pattern1, lambda m: m.group(2), content)
    
    # Pattern: English word + Chinese word + English word  
    mixed_pattern2 = r'([a-zA-Z]+)([ä¸€-é¾¯]+)([a-zA-Z]+)'
    content = re.sub(mixed_pattern2, lambda m: m.group(1) + m.group(3), content)
    
    # Pattern: Chinese characters at start/end of lines in comments
    comment_pattern = r'(#\s*)([ä¸€-é¾¯\s]+)([A-Z][a-zA-Z\s]+)'
    content = re.sub(comment_pattern, lambda m: m.group(1) + m.group(3), content)
    
    # Remove any remaining isolated Chinese characters
    content = re.sub(r'(?<![a-zA-Z])[ä¸€-é¾¯](?![a-zA-Z])', '', content)
    
    # Write back if changes were made
    if content != original_content:
        with open(python_file, 'w', encoding='utf-8') as f:
            f.write(content)
        print(f"Fixed {changes_made} Chinese text patterns in {python_file}")
        return True
    
    return False

def check_remaining_chinese():
    """Check for any remaining Chinese text"""
    python_file = "src/battery_analysis/main/main_window.py"
    
    with open(python_file, 'r', encoding='utf-8') as f:
        content = f.read()
    
    # Find all lines with Chinese characters
    chinese_lines = []
    for i, line in enumerate(content.split('\n'), 1):
        if re.search(r'[ä¸€-é¾¯]', line):
            chinese_lines.append((i, line.strip()))
    
    if chinese_lines:
        print(f"Found {len(chinese_lines)} lines with Chinese text:")
        for line_num, line in chinese_lines[:10]:  # Show first 10
            print(f"  Line {line_num}: {line}")
        if len(chinese_lines) > 10:
            print(f"  ... and {len(chinese_lines) - 10} more lines")
    else:
        print("No Chinese text found! ğŸ‰")
    
    return len(chinese_lines)

if __name__ == "__main__":
    print("Running comprehensive internationalization for main_window.py...")
    fixed = internationalize_main_window()
    
    if fixed:
        print("\nChecking for remaining Chinese text...")
        remaining = check_remaining_chinese()
        
        if remaining == 0:
            print("\nâœ… SUCCESS! main_window.py is completely internationalized!")
        else:
            print(f"\nâš ï¸  {remaining} lines still contain Chinese text and need manual review.")
    else:
        print("No changes were made.")
        check_remaining_chinese()